
\chapter{Processing} \label{Proc}

This section comprises all the input blocks that do some kind of pre--
or post--processing.

\section{Linear Optics Calculation} \label{LinOpt}

\subparagraph{Description} The linear optics calculation input block
is used to make a printout of all linear parameters (magnet lengths,
$\beta$ and $\alpha$ functions, tunes, dispersion and closed orbit) in
the horizontal and vertical planes at the end of each element or
linear block.  The number of elements or blocks can be chosen.

\subparagraph{Keyword} LINE \subparagraph{Number of data lines}
variable but at least 1

\subparagraph{Format}
\begin{itemize}
\item first data line: {\em mode number--of--blocks ilin ntco E\_I E\_II}
\item other data lines: {\em name(1), \dots , name(nlin)}
\end{itemize}


\begin{description}
\item [mode] ``ELEMENT'' for a printout after each single element
  (\ref{SinEle}); ``BLOCK'' for a printout after each structure block
  (\ref{BloDef})
\item [number--of--blocks] (integer) The number of the blocks in the
  structure to which the linear parameter will be printed. If this
  number is set to zero or is larger than the number of blocks, the
  complete structure will be calculated.
\item [ilin] (integer) Logical switch to calculate the traditional
  linear optics calculation in 4D ({\it 1 = ilin}) and with the DA
  approach 6D ({\it 2 = ilin}).
\item [ntco] (integer) A switch to write out linear coupling
  parameters.
 \begin{itemize}
 \item {\em ntco} \/= 0 : no write--out
 \item {\em ntco} \/$\neq$ 0 : write--out of all linear coupled (4D)
   parameters including the coupling angle.  These parameters (name,
   longitudinal position, the phase advances at that location, 4
   $\beta$--, $\alpha$-- and $\gamma$--functions, 4 angles for
   coordinates and momenta respectively, plus the coupling angle
   [rad]) are written in ascii format on file \# 11.
   This write-out happens every \emph{ntco} turns.
 \end{itemize}
\item [E\_I, E\_II] (floats) The two eigen--emittances to be chosen to
  determine the coupling angle. They are typically set to be equal.
\item [names] (char) For {\em nlin} \/($\leq $ {\em nele}\/) element--
  and block names the linear parameters are printed whenever they
  appear in the accelerator structure.
\end{description}

\subparagraph{Remarks}
\begin{enumerate}
\item To make this block work the Tracking Parameter block
  (~\ref{TraPar}) has to used as well.
\item When the ``ELEMENT 0'' option is used a file unit \# 34 is
  written with the longitudinal position, name, element type,
  multipole strength, $\beta$ functions and phase advances in the
  horizontal and vertical phase space respectively. This file is used
  as input for the ``SODD'' program~\cite{SODD} to calculate detuning
  and distortion terms in first and second order. A full program suite
  can be found at: /afs/cern.ch/group/si/slap/share/sodd
\item If the ``BLOCK'' option has been used, the tunes may be wrong by
  a multiple of 1/2. This option is not active in the DA part ({\it 2
    = ilin}), which also ignores the ({\it NTCO}) option.
\end{enumerate}

\section{Tune Variation} \label{TunVar}

\subparagraph{Description} This input block initializes a tune
adjustment with zero length quadrupoles.  This is normally done with
two families of focusing and defocusing quadrupoles. It may be
necessary, however, to have a fixed phase advance between certain
positions in the machine. This can be done with this block by
splitting the corresponding family into two sub--families which then
are adjusted to give the desired phase advance.

\subparagraph{Keyword} TUNE \subparagraph{Number of data lines} 2 or 4

\subparagraph{Format}
\begin{itemize}
\item data lines 1: {\em name1 Qx iqmod6}
\item data lines 2: {\em name2 Qy}
\item data lines 3 and 4, optional: {\em name3 $\Delta Q$} \/and {\em
    name4 name5} \/respectively
\end{itemize}

\begin{description}
\item [name1, name2] Names of focusing and defocusing quadrupole
  families respectively (in the single element list (~\ref{LinEle})
\item [Qx, Qy] (floats) Horizontal and vertical tune {\em including}
  \/the integer part
\item [iqmod6] (integer) Logical switch to calculate the tunes in the
  traditional manner ({\it 1 = iqmod6}) and with the DA approach
  including the beam-beam kick ({\it 2 = iqmod6}).
\item [name3] Name of the second sub--family, where the first
  sub--family is one of the above ({\em name1} \/or {\em name2}\/)
  This second sub--family replaces the elements of the first
  sub--family between the positions marked by {\em name4} \/and {\em
    name5}\/.
\item [$\Delta Q$] Extra phase advance {\em including} \/the integer
  part (horizontal or vertical depending on the first sub--family)
  between the positions in the machine marked by {\em name4} \/and
  {\em name5}
\item [name4, name5] Two markers in the machine for the phase advance
  $\Delta Q$ with the elements of the second sub--family between them
\end{description}

\subparagraph{Remark} The integer has to be included as the full phase
advance around the machine is calculated by the program.

\section{Chromaticity Correction} \label{ChrCor}

\subparagraph{Description} The chromaticity can be adjusted
to desired values with two sextupole family using this input block.

\subparagraph{Keyword} CHRO \subparagraph{Number of data lines} 2

\subparagraph{Format} data lines 1: {\em name1 $Q'_x$ ichrom}
\subparagraph{Format} data lines 2: {\em name2 $Q'_y$}

\begin{description}
\item [name1/2] Names (in the single element list (~\ref{NonEle}) of the
  two sextupole families
\item [$Q'$] Desired values of the chromaticity: $Q'=\frac{\delta
    Q}{\delta (\frac{\Delta p}{p_o})}$.
\item [ichrom] (integer) Logical switch to calculate the traditional
  chromaticity calculation ({\it 1 = ichrom}) and with the DA
  approach including the beam-beam kick ({\it 2 = ichrom}).
\end{description}
\subparagraph{Remark} To make the chromaticity correction work well a
small momentum spread is required (DE0 in table (~\ref{T-IteErr})). It
sometimes is required to optimize this spread.

\section{Orbit Correction} \label{OrbCorr}

\subparagraph{Description} Due to dipole errors in a real accelerator
a closed orbit different from the beam axis is unavoidable. Even after
careful adjustment one always will be left over with some random
deviation of the closed orbit around the zero position. A closed orbit
is introduced by nonzero strengths of $ b_{1} $ and $ a_{1} $
components of the multipole block (~\ref{MulCoe}), horizontal and
vertical dipole kicks (~\ref{NonEle}) or displacements of nonlinear
elements (~\ref{DisEle}).  This input data block allows the correction
of a such a random distributed closed orbit using he first two types
in a ``most effective corrector strategy'' \cite{Auti}. For that
purpose correctors have to be denoted by {\em ``HCOR= ''} \/and {\em
  ``VCOR= ''} \/and monitors by {\em ``HMON= ''} \/and {\em ``VMON=
  ''} \/for the horizontal and vertical plane respectively. After
correction the orbit is scaled to the desired r.m.s. values unless they
are zero.

On file unit 28 the horizontal orbit displacement, measured at the
horizontal monitors, will be written together with the monitor number,
on file unit 29 the same is done for the vertical closed orbit
displacement. 

\subparagraph{Keyword} ORBI \subparagraph{Number of data lines}
variable but at least 1

\subparagraph{Format}
\begin{itemize}
\item first data line: {\em sigmax sigmay ncorru ncorrep}
\item other data lines: {\em ``HCOR= '' namec} \/or {\em ``HMON= ''
    namem} \newline or {\em ``VCOR= '' namec} \/or {\em ``VMON= ''
    namem}
\end{itemize}

\begin{description}
\item [sigmax, sigmay] Desired r.m.s.--values of the randomly distributed
  closed orbit
\item [ncorru] Number of correctors to be used
\item [ncorrep] Number of corrections \newline If {\em ncorrep=0}
  \/the correction is iterated until {\em ITCO} \/(see
  table~\ref{T-IteErr}) iterations or after the both desired
  r.m.s.--values have been reached.
\item [``HCOR= '' namec] Horizontal correction element of name {\em
    namec}
\item [``HMON= '' namem] Horizontal monitor for the closed orbit of
  name {\em namem}
\item [``VCOR= '' namec] Vertical correction element of name {\em
    namec}
\item [``VMON= '' namem] Vertical monitor for the closed orbit of name
  {\em namem}
\end{description}

\subparagraph{Remarks}
\begin{enumerate}
\item Elements can have only one extra functionality: either
  horizontal corrector, horizontal monitor, vertical corrector or
  vertical monitor. If the number of monitors in a plane is smaller
  than the number of correctors it is likely to encounter numerical
  problems.
\item The {\em ``HCOR= ''}\/, {\em ``HMON= ''}\/, {\em ``VCOR= ''}
  \/and {\em ``VMON= ''} \/must be separated from the following name
  by at least one space.
\end{enumerate}

\section{Decoupling of Motion in the Transverse Planes}
\label{LinDec} 

\subparagraph{Description} Skew--quadrupole components in the lattice
create a linear coupling between the transverse planes of motion. A
decoupling can be achieved with this block using four independent
families of skew--quadrupoles, which cancel the off--diagonal parts of
the transfer map. As these skew--quadrupoles also influence the tunes
an adjustment of the tunes is performed at the same time.

\subparagraph{Keyword} DECO \subparagraph{Number of data lines} 3

\subparagraph{Format}
\begin{itemize}
\item first data line: {\em name1,name2,name3,name4}
\item data lines 2 and 3: {\em name5 Qx} \/and {\em name6 Qy}
  \/respectively
\end{itemize}

\begin{description}
\item [name1,2,3,4] Names of the four skew--quadrupole families
\item [name5, name6] Names of focusing and defocusing quadrupole
  families respectively (in the single element list (~\ref{LinEle})
\item [Qx, Qy] (floats) Horizontal and vertical tune {\em including}
  \/the integer part
\end{description}

\subparagraph{Remark} A decoupling can also be achieved by
compensating skew--resonances (~\ref{ResCom}).  The two approaches,
however, are not always equivalent. In the resonance approach the
zeroth harmonic is compensated, whilst a decoupling also takes into
account the higher--order terms.

\section{Sub--resonance Calculation} \label{SubCal}

\subparagraph{Description} First order resonance widths of multipoles
from second to ninth order are calculated following the approach of
Guignard \cite{Gilbert78}. This includes resonances, which are a
multiple of two lower than the order of the multipole. The first order
detuning including feed--down from closed orbit is calculated from all
multipoles up to to tenth order.

\subparagraph{Keyword} SUBR \subparagraph{Number of data lines} 1

\subparagraph{Format} {\em n1 n2 Qx Qy Ax Ay Ip length}

\begin{description}
\item [n1, n2] (integers) Lowest and highest order of the resonance
\item [Qx, Qy] Horizontal and vertical tune including the integer part
\item [Ax, Ay] Horizontal and vertical amplitudes in mm
\item [Ip] (integer) Is a switch to change the nearest distance to the
  resonance \mbox{$ e = nxQx + nyQy $.} In cases of structure
  resonances a change of $p$ by one unit may be useful.
 \begin{itemize}
 \item {\em ip} \/= 0 : $e$ is unchanged
 \item {\em ip} \/= 1 : \mbox{$ (e \pm 1) = nxQx + nyQy - (p \pm 1) $}
 \end{itemize}
\item [length] Length of the accelerator in meters
\end{description}

\section{Search for Optimum
  Places to Compensate Resonances} \label{SeaPla}

\subparagraph{Description} To be able to compensate a specific
resonance one has to know how a correcting multipole affects the
cosine and sine like terms of the resonance width at a given position
in the ring. This input data block can be used to find best places for
the compensation of up to three different resonances, by calculating
the contribution to the resonance width for a variable number of
positions. For each position the effect of a fixed and small change of
magnetic strength on those resonance widths is tested.

\subparagraph{Keyword} SEAR \subparagraph{Number of data lines}
variable but at least 2

\subparagraph{Format}
\begin{itemize}
\item data line 1: {\em Qx Qy Ax Ay length}
\item data line 2: {\em npos n ny1 ny2 ny3 ip1 ip2 ip3} \/(integers)
\item data lines from 3 on: {\em name1, \dots , namen}
\end{itemize}

\begin{description}
\item [Qx, Qy] Horizontal and vertical tune including the integer part
\item [Ax, Ay] Horizontal and vertical amplitudes in mm
\item [length] Length of the accelerator in m
\item [npos] Number of positions to be checked
\item [n] Order of the resonance
\item [ny1, ny2, ny3] Define three resonances of order $n$ via :
  \mbox{$ nx Qx + ny Qy = p $} with \mbox{$ \vert nx \vert + \vert ny
    \vert = n $}
\item [ip1,ip2,ip3] The distance to a resonance is changed by an
  integer $ip$ for each of the three resonances: \mbox{$ e = nx Qx +
    ny Qy - (p + ip) $.}
\item [namei] i'th name of a multipole of order $n$ , which has to
  appear in the single element list (~\ref{NonEle})
\end{description}

\section{Resonance Compensation} \label{ResCom}

\subparagraph{Description} The input block allows the compensation of
up to three different resonances of order $n$ simultaneously the
chromaticity and the tunes can be adjusted. For mostly academic
interest there is also the possibility to consider sub--resonances
which come from multipoles which are a multiple of 2 larger than the
resonance order $n$. However, it must be stated that the
sub--resonances depend differently on the amplitude compared to
resonances where the order of the resonances is the same as that of
the multipoles.

\subparagraph{Keyword} RESO \subparagraph{Number of data lines} 6

\subparagraph{Format}
\begin{itemize}
\item data line 1: {\em nr n ny1 ny2 ny3 ip1 ip2 ip3} \/(integers)
\item data line 2: {\em nrs ns1 ns2 ns3} \/(integers)
\item data line 3: {\em length Qx Qy Ax Ay}
\item data line 4: {\em name1, \dots, name6}
\item data line 5: {\em nch name7 name8}
\item data line 6: {\em nq name9 name10 Qx0 Qy0}
\end{itemize}

\begin{description}
\item [nr] Number of resonances (0 to 3)
\item [n] Order of the resonance, which is limited to {\em nrco} \/= 5
  (see list of parameters in Appendix~\ref{DSP}).
  
  \mbox{normal: $ 3 \le n \le nrco $; skew: $ 2 \le n \le nrco $}
\item [ny1, ny2, ny3] Define three resonances of order $n$ via :
  \mbox{$ nx Qx + ny Qy = p $} with \mbox{$ \vert nx \vert + \vert ny
    \vert = n $}
\item [ip1, ip2, ip3] The distance to the resonance $ e $ can be
  changed by an integer value: \newline \mbox{$ e = nx Qx + ny Qy -
    (p+ip) $.}
\item [nrs] Number of sub--resonances (0 to 3)
\item [ns1, ns2, ns3] Order of the multipole with \mbox{$ ns \le 9 $}
  and \mbox{$ (ns-n)/2 \in {\mathbf N} $}
\item [length] Length of the machine in meters
\item [Qx, Qy] Horizontal and vertical tune including the integer part
\item [Ax, Ay] Horizontal and vertical amplitudes in mm
\item [name1, \dots, name6] Names (~\ref{NonEle}) of the correction
  multipoles for the first, second and third resonance
\item [nch] (integer) Switch for the chromaticity correction (0 = off,
  1 = on)
\item [name7, name8] Names (~\ref{NonEle}) of the families of
  sextupoles to correct the chromaticity
\item [nq] (integer) Switch for the tune adjustment (0 = off, 1 = on)
\item [name9, name10] Names (~\ref{LinEle}) of the families of
  quadrupoles to adjust the tune
\item [Qx0, Qy0] Desired tune values including the integer part
\end{description}

\section{Differential Algebra} \label{DifAlg}

\subparagraph{Description} This input block initiates the calculation
of a one turn map using the LBL Differential Algebra
package~\cite{DALIE}.  The use of this block inhibits
post--processing. The same differential algebra tools allow a
subsequent normal form analysis (see \cite{Forest89}).  A
four--dimensional version integrated in SixTrack is available as
described in sections~\ref{Normal} and~\ref{Corrections}.

\subparagraph{Keyword} DIFF.  \subparagraph{Number of data lines} 1 or
2

\subparagraph{Format}
\begin{itemize}
\item data line 1: {\em nord nvar preda nsix ncor}
\item data line 2: {\em name(1),\ldots,name(ncor)}
\end{itemize}

\begin{description}
\item [nord] (integer) Order of the map
\item [nvar] (integer) Number of the variables (2 to 6).  {\em nvar}
  \/= 2,4,6 : two-- and four--dimensional transverse motion and full
  six--dimensional phase space respectively.  {\em nvar} \/= 5 :
  four--dimensional transverse motion plus the relative momentum
  deviation \mbox{$ \frac{\Delta p}{p_o} $} as a parameter.
\item [preda] Precision needed by the DA package, usually set to
  \mbox{{\em preda} \/= 1e-38}
\item [nsix] (integer) switch to calculate a $ 5 \times 6 $ instead of a $
  6 \times 6 $ map. This saves computational time and memory space, as the
  machine can be treated up to the cavity as five--dimensional (
  constant momentum ).

 \begin{itemize}
 \item {\em nsix} \/= 0 : $ 6x6 $ map
 \item {\em nsix} \/= 1 : $ 5x6 $ map \\
   ({\em nvar} \/must be set to 6; 6D closed orbit must not be
   calculated, i.e. \mbox{\em iclo6 = 0}~(\ref{IniCoo}) and the map
   calculation is stopped once a cavity has been reached and being
   evaluated.)
 \end{itemize}
\item [ncor] (integer) Number of zero--length elements to be
  additional parameters besides the transverse and/or longitudinal
  coordinates (i.e.\ two--, four--, five-- or six--dimensional phase
  space).
\item [name(i)] (char) {\em Ncor} \/names (~\ref{NonEle}) of
  zero--length elements (e.g dipole kicks, quadrupole kicks,
  sextupoles kicks etc.).
\end{description}

\subparagraph{Remarks}
\begin{itemize}
\item For {\em nsix = 1} \/the map can only be calculated till a
  cavity is reached.
\item If the 6D closed orbit is calculated, the $ 5x6 $ map can not be
  done, {\em nsix} \/is therefore forced to 0.
\item If nvar is set to 5, the momentum dependence is determined
  without the need for including a fake cavity. With other words: the
  linear blocks are automatically broken up into single linear
  elements so that the momentum dependence can be calculated.
\item If a DA map is needed at some longitudinal location one just has
  to introduce an element denoted ``DAMAP'' at that place in the
  structure, ``DAMAP'' has also to appear as a marker (zero length,
  element type = 0) in the single element list (~\ref{NonEle}).  This
  extra map is written to file \# 17.
\end{itemize}

\section{Normal Forms} \label{Normal}

\subparagraph{Description} All the parameters to compute the Normal
Form of a truncated one--turn map are given in the {\em Normal Form }
\/input block. Details on these procedures including the next
block~\ref{Corrections} can be found in reference \cite{Massimo}.

\subparagraph{Keyword} NORM \subparagraph{Number of data lines} 1

\subparagraph{Format}
\begin{itemize}
\item first data line: {\em nord nvar}
\end{itemize}

\begin{description}
\item [nord] (integer) Order of the Normal Form
\item [nvar] (integer) Number of variables
\end{description}

\subparagraph{Remarks}
\begin{itemize}
\item The {\em Normal Form } \/input block has to be used in
  conjunction with the {\em Differential Algebra } \/input block that
  computes the one--turn map of the accelerator.
\item The value of the parameter {\em nord} \/should not exceed the
  order specified for the transfer map plus one.
\item The value of the parameter {\em nvar} \/should be equal to the
  number of coordinates used to compute the map plus eventually the
  number of correctors specified in the {\em Differential Algebra }
  \/input block.
\item the value $1$ for the off--momentum order is forbidden. This
  case corresponds to the linear chromaticity correction. It is in
  fact corrected by default when $par1 =1$ or $par2 =2$.
\end{itemize}

\section{Corrections} \label{Corrections}

\subparagraph{Description} All the parameters to optimise the
tune--shift using a set of correctors are given in the {\em Correction
  } \/input block. (For details see reference \cite{Massimo}.)

\subparagraph{Keyword} CORR \subparagraph{Number of data lines} 3

\subparagraph{Format}
\begin{itemize}
\item first data line: {\em ctype ncor}
\item second data line: {\em name(1),\ldots,name(ncor)}
\item third data line: {\em par1,\ldots,par5}
\end{itemize}

\begin{description}
\item [ctype] (integer) Correction type :
\begin{itemize}
\item ctype = 0 order--by--order correction
\item ctype = 1 global correction
\end{itemize}
\item [ncor] (integer) Number of zero--length elements to be used as
  correctors in the optimisation of the tune--shift.
\item [name(i)] (char) {\em Ncor} \/names of zero--length elements
  (e.g sextupoles kicks, octupoles kicks etc.).
\item [par1,\ldots,par5] Parameters for the correction. Their meaning
  depend on the value of {\em ctype} \/and is explained in Table \ref{tab:CORR}.
\end{description}
\begin{table}
\begin{center}
\caption{Tune-shift correction parameters}
\label{tab:CORR}
\begin{tabular}{|c|c|c|c|c|c|}
  \hline
  & & & & & \\
  & par1 & par2 & par3 & par4 & par5 \\
  & & & & & \\
  \hline
  & & & & & \\
  variable type & integer & integer & real & real & real \\
  & & & & & \\
  \hline
  & & & & & \\
  ctype = 0 & tune--shift & off--momentum & 0.0 & 0.0 & 0.0 \\
  & order $\leq 2 $& order $\leq 3 $& & & \\
  & & & & & \\
  \hline
  & & & & & \\
  ctype = 1 & $N_{min}\geq 2$ & $N_{max}\leq 3$ & $\alpha_H$ &
  $\alpha_V$ &
  $\delta_0 $ \\
  & & & & & \\
  \hline
\end{tabular}
\end{center}
\end{table}
\subparagraph{Remarks}
\begin{itemize}
\item The names of the elements specified in the {\em Correction }
  \/input block should be grouped according to the multipole type:
  first sextupoles, then octupoles $\ldots$ etc.\ 
\item In case of order--by--order corrections, at least one of the
  quantities $par1,par2$ has to be zero, i.e.\ the correction of
  tune--shift terms depending on both amplitude and momentum is not
  allowed (as stated in the previous section).
\end{itemize}

\section{Post--processing} \label{PosPro}

\subparagraph{Description} It has been seen in the past that the
tracking data hold a large amount of information which should be
extracted for a thorough understanding of the nonlinear motion. It is
therefore necessary to store the tracking data turn by turn and
post--process it after the tracking has been finished. The following
quantities are calculated:
\begin{enumerate}
\item {\bf Lyapunov exponent analysis} This allows to decide if the
  motion is of regular or chaotic nature, and, in the later case, that
  the particle will ultimately be lost.  This is done with the
  following procedure:
 \begin{enumerate}
 \item Start the analysis where the distance in phase space of the two
   particles reaches its minimum.
 \item Study the increase in a double logarithmic scale so that the
   slope in a regular case is always one, while a exponential increase
   stays exponential when we have chaos.
 \item Average the distance in phase space to reduce local
   fluctuations, as we are interested in a long range effect.
 \item Make a weighted linear fit with an increasing number of
   averaged values of distance in phase space, so that an exponential
   increase results in a slope that is larger than one and is
   increasing. (The weighting stresses the importance of values at
   large turn numbers).
 \end{enumerate}
\item {\bf Analysis of the tunes} This is done either by the averaged
  phase advance method leading to very precise values of the
  horizontal and vertical tunes. A FFT analysis is also done.  With
  the second method one can evaluate the relative strength of
  resonances, rather than achieve a precise tune measurement. In both
  cases the nearby resonances are determined.
\item {\bf Smear} The smear of the horizontal and vertical emittances
  and the sum of the emittances are calculated in case of linearly
  coupled and un--coupled motion.
\item {\bf Nonlinear Invariants} A rough estimate of the nonlinear
  invariants are given.
\item {\bf Plotting} The processed tracking data can be plotted in
  different ways:
 \begin{enumerate}
 \item The distance of phase space as a function of amplitude
 \item Phase space plots
 \item Stroboscoped phase space
 \item FFT amplitudes
 \end{enumerate}
\item {\bf Summary} The post--processing results for a complete
  tracking session with varying initial parameters are summarised in a
  table at the end of the run.
\end{enumerate}

\subparagraph{Keyword} POST \subparagraph{Number of data lines} 4

\subparagraph{Format}
\begin{itemize}
\item data line 1: {\em comment title}
\item data line 2: {\em iav nstart nstop iwg dphix dphiy iskip iconv
    imad cma1 cma2} \/(general parameters)
\item data line 3: {\em Qx0 Qy0 ivox ivoy ires dres ifh dfft}
  \/(parameters for the tune calculation)
\item data line 4: {\em kwtype itf icr idis icow istw iffw nprint
    ndafi} \/(integer parameters for the plotting)
\end{itemize}

\begin{description}
\item [iav] (integer) Averaging interval of the values of the distance
  in phase space. Typically a tenth of the total turn number should be
  used as this interval.
\item [nstart, nstop] (integers) Start and stop turn number for the
  analysis of the post--processing (0 0 = all data used).
\item [iwg] (integer) Switch for the weighting of the slope
  calculation of the distance in phase space (0 = off, 1 = on).
\item [dphix, dphiy] Horizontal and vertical angle interval in radians
  that is used to stroboscope phase space. This stroboscoping of one
  of the two phase space projections is done by restricting the angle
  in the other phase space respectively to lie inside $\pm$ {\em
    dphix} \/or $\pm$ {\em dphiy}.
\item [iskip] (integer) This parameter allows to reduce the number of
  data to be processed: only each {\em iskip} \/sample of data will be
  used.
\item [iconv] (integer) If {\em iconv} \/is set to 1 the tracking data
  are not normalised linearly. Sometimes it is necessary to compare
  normalised to unnormalised data as the later will be found in the
  real machine.
\item [imad] (integer) This parameters is useful when MAD data shall
  be analysed ({\em imad} \/set to one).
\item [cma1, cma2] (floats) To improve the Lyapunov analysis for MAD
  data and in the case that the motion is 6D but the 6D closed orbit
  is not calculated the off--momentum and the path--length difference
  ($\sigma = s - v_o \times t$) can be scaled with {\em cma1} \/and
  {\em cma2} \/respectively (see also~\ref{SynOsc}). Please set both
  to 1.  when the 6D closed orbit is calculated.
\item [Qx0, Qy0] (floats) Values of the horizontal and vertical tune
  respectively (integer part) to be added to the averaged phase
  advance and to the $Q$ values of the FFT analysis.
\item [ivox, ivoy] (integers) The tunes from the average phase advance
  are difficult to be calculated when this phase advance is strongly
  changing from turn to turn and when the tune is close to 0.5, as
  then the phase may become negative leading to a deviation of one
  unit. This problem can partly be overcome by setting these switches
  in the following way:
 \begin{itemize}
 \item tune close to an integer: {\em ivox, ivoy} \/= 1
 \item tune close to half an integer: {\em ivox, ivoy} \/= 0
 \end {itemize}
\item [ires, dres] (integer,float) For the calculated tune values from
  the average phase advance method and the FFT--routine the closest
  resonances are searched up to {\em ires}\/'th order and inside a
  maximum distance to the resonance {\em dres}\/, so that \mbox{$ nx
    Qx + ny Qy < dres $ and $ nx + ny \le ires $.}
\item [ifh, dfft] (integer,float) For the FFT analysis the tune
  interval can be chosen with {\em ifh}\/.  To find resonances with
  the FFT spectrum, all peaks below a fraction {\em dfft} \/of the
  maximum peak are accepted.
 \begin{itemize}
 \item {\em ifh} \/= 0 : $ 0 \le Q \le 1 $
 \item {\em ifh} \/= 1 : $ 0 \le Q \le 0.5 $
 \item {\em ifh} \/= 2 : $ 0.5 \le Q \le 1 $
 \end{itemize}
\item [kwtype] {\large -- Disabled, set to 0 --} ({\small Terminal
    type, e.g. 7878 for the Pericom graphic terminals. For details,
    consult the HPLOT manual \cite{HPLOT}.})
\item [itf] Switch to get PS--file of plots
  \begin{itemize}
  \item {\em itf} = 0 : off
  \item {\em itf} = 1 : on
  \end{itemize}
\item [icr] {\large -- Disabled, set to 0 --} ({\small Switch to stop
    after each plot (0 = no stop, 1 = stop after each plot).}
\item [idis, icow, istw, iffw] Switches (0 = off) to select the
  different plots. If all values are set to zero, the HBOOK/HPLOT
  routine will not be called.
  \begin{itemize}
  \item {\em idis} \/= 1 : plot of distance in phase space
  \item {\em icow} \/= 1 : a set of plots of projections of the
    six--dimensional phase space and the energy E versus the turn
    number
  \item {\em istw} \/= 1 : plot of the stroboscoped phase space
    projection by restricting the phase in the other phase space
    projection
  \item {\em iffw} \/= 1 : plots of the horizontal and vertical FFT
    spectrum with linear amplitude scale
  \item {\em iffw} \/= 2 : plots of the horizontal and vertical FFT
    spectrum with logarithmic amplitude scale
  \end{itemize}
\item [nprint] Switch to stop the printing of the post--processing
  output to unit 6 (0 = printing off, 1 = printing on).
\item [ndafi] Number of data--files to be processed \mbox{(units :
    from 90 to (90--ndafi+1)\hspace{3mm}).}
\end{description}

\subparagraph{Remarks}
\begin{enumerate}
\item The post--processing can be done in two ways :
\begin{enumerate}
\item directly following a tracking run by adding this input block to
  the input blocks of the tracking
\item as a later run where the tracking parameter file (unit \# 3)
  consists of only the {\em Program Version} \/input
  block~\ref{ProVer} (using the {\em FREE} \/option) and of this input
  block specifying the post--processing parameters followed by {\em
    ENDE} \/as usual
\end{enumerate}
\item The HBOOK/HPLOT routines are only used at the start of the main
  program for initialisation and termination. The actual plots are
  done in the post--processing subroutine. The routines are activated
  only if at least one of the plotting parameters ({\em idis, icow,
    istw, iffw}\/) is set to one.
\end{enumerate}

